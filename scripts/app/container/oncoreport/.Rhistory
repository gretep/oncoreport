View(results$COAD_S1)
View(results$COAD_S2)
View(results$COAD_S3)
View(results$COAD_S4)
results$COAD_S1
results$COAD_S1
class(results$COAD_S1)
names(results$COAD_S1)
gsub(" - homo sapiens (human)", "", tolower(names(results$COAD_S1)))
gsub(pattern = " - homo sapiens (human)", replacement = "", x = tolower(names(results$COAD_S1)))
gsub(pattern = " \- homo sapiens \(human\)", replacement = "", x = tolower(names(results$COAD_S1)))
gsub(pattern = " - homo sapiens (human)", replacement = "", x = tolower(names(results$COAD_S1)), fixed = TRUE)
names(results$BRCA_S1)
View(results$BRCA_S1)
View(result.BRCA)
View(result.COAD)
load("I:/specific/tmp/desubs.RData")
View(results1$COAD_S1)
load("I:/specific/tmp/specific.RData")
source('~/.active-rstudio-document')
results.norm$COAD_S1
mean(c(0,0,0,0,0))
names(results.norm[[1]])
tmp <- names(results.norm[[1]])
for (t in tests) {
results.norm[[t]] <- results.norm[[t]][tmp]
}
results.norm
Reduce(cbind, results.norm)
View(Reduce(cbind, results.norm))
View(Reduce(cbind, results.norm[1:4]))
rowMeans(Reduce(cbind, results.norm[1:4]))
apply(Reduce(cbind, results.norm[1:4])),1,median)
apply(Reduce(cbind, results.norm[1:4]),1,median)
View(apply(Reduce(cbind, results.norm[1:4]),1,median))
COAD <- apply(Reduce(cbind, results.norm[1:4]),1,median)
names(results.norm)[1:4]
BRCA <- apply(Reduce(cbind, results.norm[5:8]),1,median)
tmp <- names(results.norm[[1]])
for (t in tests) {
results.norm[[t]] <- results.norm[[t]][tmp]
}
COAD <- apply(Reduce(cbind, results.norm[1:4]),1,median)
BRCA <- apply(Reduce(cbind, results.norm[5:8]),1,median)
tmp <- names(results.norm[[1]])
for (t in tests) {
results.norm[[t]] <- results.norm[[t]][tmp]
}
COAD <- sort(apply(Reduce(cbind, results.norm[1:4]),1,median), decreasing = TRUE)
BRCA <- sort(apply(Reduce(cbind, results.norm[5:8]),1,median), decreasing = TRUE)
BRCA
COAD <- COAD[COAD != 0]
BRCA <- BRCA[BRCA != 0]
COAD
COAD
source('I:/specific/tmp/compute.R')
rm(BRCA)
rm(COAD)
read.table("http://rest.kegg.jp/list/pathway/hsa", header=FALSE, sep="\t", row.names = 1)
View(read.table("http://rest.kegg.jp/list/pathway/hsa", header=FALSE, sep="\t", row.names = 1))
pathways <- read.delim("C:\\Users\\alaim\\AppData\\Local\\Temp\\Rtmp4i6a25\\data50d0342658e", header=FALSE, row.names=1)
View(pathways)
pathways <- read.delim("http://rest.kegg.jp/list/pathway/hsa", header=FALSE, row.names=1)
View(pathways)
pathways[â˜º,1]
pathways[,1]
as.character(pathways[,1])
tmp <- read.delim("http://rest.kegg.jp/list/pathway/hsa", header=FALSE, row.names=1)
pathways <- as.character(tmp[,1])
names(pathways) <- rownames(tmp)
pathways
pathways[exclude]
exclude <- c("path:hsa05210","path:hsa05211","path:hsa05212","path:hsa05213","path:hsa05214",
"path:hsa05215","path:hsa05216","path:hsa05217","path:hsa05218","path:hsa05219",
"path:hsa05220","path:hsa05221","path:hsa05222","path:hsa05223","path:hsa05224",
"path:hsa05010","path:hsa05012","path:hsa05014","path:hsa05016","path:hsa05020",
"path:hsa05030","path:hsa05031","path:hsa05032","path:hsa05033","path:hsa05034",
"path:hsa05310","path:hsa05320","path:hsa05321","path:hsa05322","path:hsa05323",
"path:hsa05330","path:hsa05332","path:hsa05340","path:hsa05410","path:hsa05412",
"path:hsa05414","path:hsa05416","path:hsa04930","path:hsa04940","path:hsa04950",
"path:hsa04932","path:hsa04931","path:hsa04933","path:hsa05110","path:hsa05120",
"path:hsa05130","path:hsa05131","path:hsa05132","path:hsa05133","path:hsa05134",
"path:hsa05150","path:hsa05152","path:hsa05100","path:hsa05166","path:hsa05162",
"path:hsa05164","path:hsa05161","path:hsa05160","path:hsa05168","path:hsa05169",
"path:hsa05146","path:hsa05144","path:hsa05145","path:hsa05140","path:hsa05142",
"path:hsa05143")
tmp <- read.delim("http://rest.kegg.jp/list/pathway/hsa", header=FALSE, row.names=1)
pathways <- as.character(tmp[,1])
names(pathways) <- rownames(tmp)
exclude.names <- norm.pathway(unname(exclude[pathways]))
norm.pathway <- function (pvs) {
return (gsub(pattern = " - homo sapiens (human)",
replacement = "",
x = tolower(names(pvs)), fixed = TRUE))
}
exclude.names <- norm.pathway(unname(exclude[pathways]))
exclude.names
exclude <- c("path:hsa05210","path:hsa05211","path:hsa05212","path:hsa05213","path:hsa05214",
"path:hsa05215","path:hsa05216","path:hsa05217","path:hsa05218","path:hsa05219",
"path:hsa05220","path:hsa05221","path:hsa05222","path:hsa05223","path:hsa05224",
"path:hsa05010","path:hsa05012","path:hsa05014","path:hsa05016","path:hsa05020",
"path:hsa05030","path:hsa05031","path:hsa05032","path:hsa05033","path:hsa05034",
"path:hsa05310","path:hsa05320","path:hsa05321","path:hsa05322","path:hsa05323",
"path:hsa05330","path:hsa05332","path:hsa05340","path:hsa05410","path:hsa05412",
"path:hsa05414","path:hsa05416","path:hsa04930","path:hsa04940","path:hsa04950",
"path:hsa04932","path:hsa04931","path:hsa04933","path:hsa05110","path:hsa05120",
"path:hsa05130","path:hsa05131","path:hsa05132","path:hsa05133","path:hsa05134",
"path:hsa05150","path:hsa05152","path:hsa05100","path:hsa05166","path:hsa05162",
"path:hsa05164","path:hsa05161","path:hsa05160","path:hsa05168","path:hsa05169",
"path:hsa05146","path:hsa05144","path:hsa05145","path:hsa05140","path:hsa05142",
"path:hsa05143")
tmp <- read.delim("http://rest.kegg.jp/list/pathway/hsa", header=FALSE, row.names=1)
pathways <- as.character(tmp[,1])
names(pathways) <- rownames(tmp)
exclude.names <- norm.pathway(unname(pathways[exclude]))
exclude.names
pathways[exclude]
unname(pathways[exclude])
norm.pathway(unname(pathways[exclude]))
norm.pathway <- function (pvs) {
return (gsub(pattern = " - homo sapiens (human)",
replacement = "",
x = tolower(pvs), fixed = TRUE))
}
exclude.names <- norm.pathway(unname(pathways[exclude]))
exclude.names
source('I:/specific/tmp/compute.R')
source('I:/specific/tmp/compute.R')
specific.COAD
norm.pathway(pathways)
source('I:/specific/tmp/compute.R')
rm(tbl,tmp,fin,results,results.norm,structs,t)
load("I:/specific/tmp/SubPathwayGM.RData")
View(result.BRCA)
sapply(strsplit(result.BRCA$pathwayId, "_"), function (x) (x[1]))
load("SubPathwayGM.RData")
result.BRCA$pathwayId <- sapply(strsplit(result.BRCA$pathwayId, "_"), function (x) (x[1]))
result.COAD$pathwayId <- sapply(strsplit(result.COAD$pathwayId, "_"), function (x) (x[1]))
View(result.BRCA)
result.BRCA$pathwayId %in% exclude
result.BRCA[!(result.BRCA$pathwayId %in% exclude),]
load("SubPathwayGM.RData")
result.BRCA$pathwayId <- sapply(strsplit(result.BRCA$pathwayId, "_"), function (x) (x[1]))
result.COAD$pathwayId <- sapply(strsplit(result.COAD$pathwayId, "_"), function (x) (x[1]))
result.BRCA <- result.BRCA[!(result.BRCA$pathwayId %in% exclude),]
result.COAD <- result.COAD[!(result.COAD$pathwayId %in% exclude),]
load("SubPathwayGM.RData")
result.BRCA$pathwayId <- sapply(strsplit(result.BRCA$pathwayId, "_"), function (x) (x[1]))
result.COAD$pathwayId <- sapply(strsplit(result.COAD$pathwayId, "_"), function (x) (x[1]))
result.BRCA <- result.BRCA[!(result.BRCA$pathwayId %in% exclude) & result.BRCA$fdr < 0.05,]
result.COAD <- result.COAD[!(result.COAD$pathwayId %in% exclude) & result.BRCA$fdr < 0.05,]
View(result.COAD)
View(result.BRCA)
pathways[result.BRCA$pathwayId]
result.BRCA$pathwayId
gsub("path:", "path:hsa", result.BRCA$pathwayId)
load("SubPathwayGM.RData")
result.BRCA$pathwayId <- gsub("path:", "path:hsa", result.BRCA$pathwayId)
result.COAD$pathwayId <- gsub("path:", "path:hsa", result.COAD$pathwayId)
result.BRCA$pathwayId <- sapply(strsplit(result.BRCA$pathwayId, "_"), function (x) (x[1]))
result.COAD$pathwayId <- sapply(strsplit(result.COAD$pathwayId, "_"), function (x) (x[1]))
result.BRCA <- result.BRCA[!(result.BRCA$pathwayId %in% exclude) & result.BRCA$fdr < 0.05,]
result.COAD <- result.COAD[!(result.COAD$pathwayId %in% exclude) & result.BRCA$fdr < 0.05,]
subGM.BRCA <- result.BRCA$fdr
names(subGM.BRCA) <- pathways[result.BRCA$pathwayId]
load("SubPathwayGM.RData")
result.BRCA$pathwayId <- gsub("path:", "path:hsa", result.BRCA$pathwayId)
result.COAD$pathwayId <- gsub("path:", "path:hsa", result.COAD$pathwayId)
result.BRCA$pathwayId <- sapply(strsplit(result.BRCA$pathwayId, "_"), function (x) (x[1]))
result.COAD$pathwayId <- sapply(strsplit(result.COAD$pathwayId, "_"), function (x) (x[1]))
result.BRCA <- result.BRCA[!(result.BRCA$pathwayId %in% exclude) & result.BRCA$fdr < 0.05,]
result.COAD <- result.COAD[!(result.COAD$pathwayId %in% exclude) & result.BRCA$fdr < 0.05,]
subGM.BRCA <- result.BRCA$fdr
names(subGM.BRCA) <- pathways[result.BRCA$pathwayId]
load("SubPathwayGM.RData")
result.BRCA$pathwayId <- gsub("path:", "path:hsa", result.BRCA$pathwayId)
result.COAD$pathwayId <- gsub("path:", "path:hsa", result.COAD$pathwayId)
result.BRCA$pathwayId <- sapply(strsplit(result.BRCA$pathwayId, "_"), function (x) (x[1]))
result.COAD$pathwayId <- sapply(strsplit(result.COAD$pathwayId, "_"), function (x) (x[1]))
result.BRCA <- result.BRCA[!(result.BRCA$pathwayId %in% exclude) & result.BRCA$fdr < 0.05,]
result.COAD <- result.COAD[!(result.COAD$pathwayId %in% exclude) & result.COAD$fdr < 0.05,]
subGM.BRCA <- result.BRCA$fdr
names(subGM.BRCA) <- pathways[result.BRCA$pathwayId]
subGM.BRCA
load("SubPathwayGM.RData")
result.BRCA$pathwayId <- gsub("path:", "path:hsa", result.BRCA$pathwayId)
result.COAD$pathwayId <- gsub("path:", "path:hsa", result.COAD$pathwayId)
result.BRCA$pathwayId <- sapply(strsplit(result.BRCA$pathwayId, "_"), function (x) (x[1]))
result.COAD$pathwayId <- sapply(strsplit(result.COAD$pathwayId, "_"), function (x) (x[1]))
result.BRCA <- result.BRCA[!(result.BRCA$pathwayId %in% exclude) & result.BRCA$fdr < 0.05,]
result.COAD <- result.COAD[!(result.COAD$pathwayId %in% exclude) & result.COAD$fdr < 0.05,]
subGM.BRCA <- result.BRCA$fdr
names(subGM.BRCA) <- pathways[result.BRCA$pathwayId]
subGM.COAD <- result.COAD$fdr
names(subGM.COAD) <- pathways[result.COAD$pathwayId]
subGM.BRCA
subGM.COAD
install.packages("VennDiagram")
library("VennDiagram", lib.loc="~/R/win-library/3.3")
names(result.BRCA)
names(specific.BRCA)
list(names(specific.BRCA),names(subGM.BRCA))
venn.diagram(list(names(specific.BRCA),names(subGM.BRCA)))
venn.diagram(list(names(specific.BRCA),names(subGM.BRCA)), "I:/specific/tmp/out.png")
venn.diagram(list(A=names(specific.BRCA),B=names(subGM.BRCA)), "I:/specific/tmp/out.png")
rm(result.BRCA,result.COAD)
load("I:/specific/tmp/SubPathwayGMir.RData")
View(result.BRCA)
View(result.BRCA)
result.BRCA$pathwayId <- gsub("path:", "path:hsa", result.BRCA$pathwayId)
result.COAD$pathwayId <- gsub("path:", "path:hsa", result.COAD$pathwayId)
result.BRCA$pathwayId <- sapply(strsplit(result.BRCA$pathwayId, "_"), function (x) (x[1]))
result.COAD$pathwayId <- sapply(strsplit(result.COAD$pathwayId, "_"), function (x) (x[1]))
View(result.BRCA)
result.BRCA <- result.BRCA[!(result.BRCA$pathwayId %in% exclude) & result.BRCA$fdr < 0.05,]
result.COAD <- result.COAD[!(result.COAD$pathwayId %in% exclude) & result.COAD$fdr < 0.05,]
View(result.BRCA)
load("SubPathwayGMir.RData")
result.BRCA$pathwayId <- gsub("path:", "path:hsa", result.BRCA$pathwayId)
result.COAD$pathwayId <- gsub("path:", "path:hsa", result.COAD$pathwayId)
result.BRCA$pathwayId <- sapply(strsplit(result.BRCA$pathwayId, "_"), function (x) (x[1]))
result.COAD$pathwayId <- sapply(strsplit(result.COAD$pathwayId, "_"), function (x) (x[1]))
result.BRCA <- result.BRCA[!(result.BRCA$pathwayId %in% exclude) & result.BRCA$fdr < 0.05,]
result.COAD <- result.COAD[!(result.COAD$pathwayId %in% exclude) & result.COAD$fdr < 0.05,]
load("SubPathwayGMir.RData")
result.BRCA$pathwayId <- gsub("path:", "path:hsa", result.BRCA$pathwayId)
result.COAD$pathwayId <- gsub("path:", "path:hsa", result.COAD$pathwayId)
result.BRCA$pathwayId <- sapply(strsplit(result.BRCA$pathwayId, "_"), function (x) (x[1]))
result.COAD$pathwayId <- sapply(strsplit(result.COAD$pathwayId, "_"), function (x) (x[1]))
result.BRCA <- result.BRCA[!(result.BRCA$pathwayId %in% exclude) & result.BRCA$fdr < 0.05,]
result.COAD <- result.COAD[!(result.COAD$pathwayId %in% exclude) & result.COAD$fdr < 0.05,]
subGMir.BRCA <- result.BRCA$fdr
names(subGMir.BRCA) <- pathways[result.BRCA$pathwayId]
subGMir.COAD <- result.COAD$fdr
names(subGMir.COAD) <- pathways[result.COAD$pathwayId]
rm(result.BRCA,result.COAD)
venn.diagram(list(A=names(specific.BRCA),B=names(subGM.BRCA),C=names(subGMir.BRCA)), "I:/specific/tmp/out.png")
load("I:/specific/tmp/desubs.RData")
results1$COAD_S1
class(results1$COAD_S1)
results1$COAD_S1
venn.diagram(list(A=names(specific.COAD),B=names(subGM.COAD),C=names(subGMir.COAD)), "I:/specific/tmp/out.COAD.png")
results1$COAD_S1
intersect(names(results1$COAD_S1), pathways)
length(names(results1$COAD_S1))
setdiff(names(results1$COAD_S1), pathways)
pathways
help(gsub)
multi.gsub <- function (patterns, replacement, x, ...) {
for (p in patterns) {
x <- gsub(pattern = p, replacement = replacement, x = x, ...)
}
return (x)
}
norm.pathway <- function (pvs) {
return (multi.gsub(patterns = c("-", "(", ")"), replacement = " ",
gsub(pattern = " - homo sapiens (human)",
replacement = "",
x = tolower(pvs), fixed = TRUE), fixed = TRUE))
}
tests <- c(
"COAD_S1",
"COAD_S2",
"COAD_S3",
"COAD_S4",
"BRCA_S1",
"BRCA_S2",
"BRCA_S3",
"BRCA_S4"
)
exclude <- c("path:hsa05210","path:hsa05211","path:hsa05212","path:hsa05213","path:hsa05214",
"path:hsa05215","path:hsa05216","path:hsa05217","path:hsa05218","path:hsa05219",
"path:hsa05220","path:hsa05221","path:hsa05222","path:hsa05223","path:hsa05224",
"path:hsa05010","path:hsa05012","path:hsa05014","path:hsa05016","path:hsa05020",
"path:hsa05030","path:hsa05031","path:hsa05032","path:hsa05033","path:hsa05034",
"path:hsa05310","path:hsa05320","path:hsa05321","path:hsa05322","path:hsa05323",
"path:hsa05330","path:hsa05332","path:hsa05340","path:hsa05410","path:hsa05412",
"path:hsa05414","path:hsa05416","path:hsa04930","path:hsa04940","path:hsa04950",
"path:hsa04932","path:hsa04931","path:hsa04933","path:hsa05110","path:hsa05120",
"path:hsa05130","path:hsa05131","path:hsa05132","path:hsa05133","path:hsa05134",
"path:hsa05150","path:hsa05152","path:hsa05100","path:hsa05166","path:hsa05162",
"path:hsa05164","path:hsa05161","path:hsa05160","path:hsa05168","path:hsa05169",
"path:hsa05146","path:hsa05144","path:hsa05145","path:hsa05140","path:hsa05142",
"path:hsa05143")
tmp <- read.delim("http://rest.kegg.jp/list/pathway/hsa", header=FALSE, row.names=1)
pathways <- as.character(tmp[,1])
names(pathways) <- rownames(tmp)
pathways <- norm.pathway(pathways)
exclude.names <- unname(pathways[exclude])
pathways
multi.gsub <- function (patterns, replacements, x, ...) {
for (i in 1:length(patterns)) {
x <- gsub(pattern = patterns[1], replacement = replacements[i], x = x, ...)
}
return (x)
}
norm.pathway <- function (pvs) {
return (multi.gsub(patterns = c("-", "(", ")"), replacement = c(" ", "",""),
gsub(pattern = " - homo sapiens (human)",
replacement = "",
x = tolower(pvs), fixed = TRUE), fixed = TRUE))
}
tests <- c(
"COAD_S1",
"COAD_S2",
"COAD_S3",
"COAD_S4",
"BRCA_S1",
"BRCA_S2",
"BRCA_S3",
"BRCA_S4"
)
exclude <- c("path:hsa05210","path:hsa05211","path:hsa05212","path:hsa05213","path:hsa05214",
"path:hsa05215","path:hsa05216","path:hsa05217","path:hsa05218","path:hsa05219",
"path:hsa05220","path:hsa05221","path:hsa05222","path:hsa05223","path:hsa05224",
"path:hsa05010","path:hsa05012","path:hsa05014","path:hsa05016","path:hsa05020",
"path:hsa05030","path:hsa05031","path:hsa05032","path:hsa05033","path:hsa05034",
"path:hsa05310","path:hsa05320","path:hsa05321","path:hsa05322","path:hsa05323",
"path:hsa05330","path:hsa05332","path:hsa05340","path:hsa05410","path:hsa05412",
"path:hsa05414","path:hsa05416","path:hsa04930","path:hsa04940","path:hsa04950",
"path:hsa04932","path:hsa04931","path:hsa04933","path:hsa05110","path:hsa05120",
"path:hsa05130","path:hsa05131","path:hsa05132","path:hsa05133","path:hsa05134",
"path:hsa05150","path:hsa05152","path:hsa05100","path:hsa05166","path:hsa05162",
"path:hsa05164","path:hsa05161","path:hsa05160","path:hsa05168","path:hsa05169",
"path:hsa05146","path:hsa05144","path:hsa05145","path:hsa05140","path:hsa05142",
"path:hsa05143")
tmp <- read.delim("http://rest.kegg.jp/list/pathway/hsa", header=FALSE, row.names=1)
pathways <- as.character(tmp[,1])
names(pathways) <- rownames(tmp)
pathways <- norm.pathway(pathways)
exclude.names <- unname(pathways[exclude])
intersect(names(results1$COAD_S1), pathways)
setdiff(names(results1$COAD_S1), pathways)
sapply(results1[1:4], names)
Reduce(c, lapply(results1[1:4], names))
unique(Reduce(c, lapply(results1[1:4], names)))
unique(Reduce(c, lapply(results1, names)))
reps        <- c("vibrio cholerae infection")
names(reps) <- c("cholera infection")
all.pathways <- unique(Reduce(c, lapply(results1, names)))
mtx.pathways <- matrix(0, nrow=length(all.pathways), ncol=length(results1), dimnames=list(all.pathways,names(results1)))
rownames(mtx.pathways) %in% reps
rownames(mtx.pathways)
rownames(mtx.pathways) %in% names(reps)
rownames(mtx.pathways)[rownames(mtx.pathways) %in% names(reps)]
load("desubs.RData")
reps        <- c("vibrio cholerae infection")
names(reps) <- c("cholera infection")
all.pathways <- unique(Reduce(c, lapply(results1, names)))
mtx.pathways <- matrix(0, nrow=length(all.pathways), ncol=length(results1), dimnames=list(all.pathways,names(results1)))
for (i in 1:length(results1)) {
mtx.pathways[names(results1[[i]]),i] <- unname(results1[[i]])
}
View(mtx.pathways)
View(mtx.pathways)
desubs.COAD <- sort(apply(mtx.pathways[,1:4],1,median), decreasing = TRUE)
desubs.BRCA <- sort(apply(mtx.pathways[,5,8]),1,median), decreasing = TRUE)
desubs.COAD <- sort(apply(mtx.pathways[,1:4],1,median), decreasing = TRUE)
desubs.BRCA <- sort(apply(mtx.pathways[,5,8],1,median), decreasing = TRUE)
desubs.COAD <- sort(apply(mtx.pathways[,1:4],1,median), decreasing = TRUE)
desubs.BRCA <- sort(apply(mtx.pathways[,5:8],1,median), decreasing = TRUE)
desubs.COAD
desubs.COAD <- sort(apply(mtx.pathways[,1:4],1,median), decreasing = TRUE)
desubs.BRCA <- sort(apply(mtx.pathways[,5:8],1,median), decreasing = TRUE)
desubs.COAD <- desubs.COAD[desubs.COAD != 0]
desubs.BRCA <- desubs.COAD[desubs.COAD != 0]
desubs.COAD <- desubs.COAD[!(names(desubs.COAD) %in% exclude.names)]
desubs.BRCA <- desubs.BRCA[!(names(desubs.BRCA) %in% exclude.names)]
desubs.COAD
desubs.BRCA
venn.diagram(list(A=names(specific.COAD),B=names(subGM.COAD),C=names(subGMir.COAD),D=names(desubs.COAD)), "I:/specific/tmp/out.COAD.png")
library(GEOquery)
ds <- getGEO("GSE105127")
setwd("/hoa")
setwd("/home/alaimos/repos/oncoreport/scripts/app/container/oncoreport/")
help("separate")
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(RCurl))
suppressPackageStartupMessages(library(tidyr))
help("separate")
help(merge)
